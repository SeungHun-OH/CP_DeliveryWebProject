<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="supportMapper">
  
  	<insert id="insert">
  		<selectKey keyProperty="inquiryNo" resultType="int"  order="BEFORE">
       		SELECT CAP_INQUIRY_SEQ.NEXTVAL AS FROM DUAL
   		</selectKey>
   		INSERT INTO CAP_DELIVERY_INQUIRY (
   											INQUIRY_NO
   											, WAYBILL_NUM
   											, NAME
   											, PHONE
   											, INQUIRY_TYPE
   											, ADDRESS
   											, ADDRESS2
   											, PRODUCT_NAME
   											, TITLE
   											, CONTENT)
   											VALUES (
   											#{inquiryNo}
   											, #{waybillNum}
   											, #{name}
   											, #{phone}
   											, #{inquiryType}
   											, #{addr}
   											, #{addr2}
   											, #{productName}
   											, #{title}
   											, #{content})
  	</insert>
  	
  	<insert id="insertFile" parameterType="FileVO" useGeneratedKeys="false">
   	<selectKey keyProperty="fileNo" resultType="int"  order="BEFORE">
       		SELECT COALESCE(MAX(FILE_NO),0)+1 as fileNo FROM CAP_DELIVERY_INQUIRY_FILE
   	</selectKey>
   			INSERT INTO CAP_DELIVERY_INQUIRY_FILE (
   											INQUIRY_NO
   											, FILE_NO
   											, FILE_NAME
   											, FILE_LOACTION
   											, FILE_SIZE)
   											VALUES (
   											CAP_INQUIRY_SEQ.CURRVAL
   											, #{fileNo}
   											, #{fileName}
   											, #{fileLocation}
   											, #{fileSize})
  	</insert>
  </mapper>